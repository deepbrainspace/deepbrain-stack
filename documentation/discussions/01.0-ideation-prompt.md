trying to work out the best way to deploy the following. ideally in full automation, maybe even gitops? or if you have any better suggestions:

1) Hetzner cloud 
- 3 x hetzner servers to form a docker swarm cluster, every node acts as worker and master to give full HA. we want to avoid SPOF across the whole ecosystem.
the servers will host the following all as docker swarm in separate independant docker compose files -
core (in /opt/core/<n>): seaweedFS, traefik, netdata
apps (in /opt/apps/<n> using seaweedFS defined dynamically replicated 2x volumes for each of them) : rocketchat, mongodb for rocketchat, a sync app, keycloak for federated unified login for the users across all the applications they use
a restic backup automation that backs up to cloudflare r2 bucket daily (7 days), weekly (4 weeks), monthly (12 months) the contents of /opt/core

- 1 x hetzner firewall with yaml ways to configure the ports.
- 1 x hetzner backup server - this will mount the seaweedFS volumes, then back them up to the R2 bucket using restic same way as above (so this would cover all the /opt/apps applications)
- 1 x hetzner private network (for all the servers above to communicate faster and securely internally)

2) cloudflare
- r2 bucket for backup
- some worker nodes (we can configure the details of the workers later on)
- cloudflare proxy that would forward requests to the hetzner swarm cluster + firewall to give good security.
- cloudflare KV backend (that takes bootstrap configs from a local yaml file)

3) gcp
- google firestore
- a series of google cloud functions (we will have about 3, but the details will be defined later on)

4) qdrant cloud configurations.

5) groqcloud configurations.

6) a vercel application (may require some serverless functions also) that will provide an interface to the cloudflare KV for secrets that can be dynamically used throughout the whole stack.

we want to keep all the configurations of everything and secrets where we can separate things out by environments, keep all the configs as yaml files cleanly organized and separated as needed. (some kind of gitops mechanism maybe? so it gets updated automatically on vercel secrets app). i am not sure yet how to manage these secrets, whether to keep everything in the git yaml file (secured by a git-crypt so we have it encrypted) as the only source of truth or just have it as the first version then the vercel secrets app just takes over. if we do the former we only need a script that would update the cloudflare KV store with the values as and when needed whenever these files are updated, could be a github action or something similar.